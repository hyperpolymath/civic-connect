# AI Assistant Specification

## Machine-Readable Artefacts

The `.machine_readable/` directory contains structured metadata required for automated reasoning and project introspection.

- `STATE.scm`: Current project state, milestones, and progress.
- `META.scm`: Architecture decisions, development methodology, and rationale.
- `ECOSYSTEM.scm`: Ecosystem placement, upstream/downstream relationships, and interoperability.
- `AGENTIC.scm`: AI agent interaction patterns, affordances, and constraints.
- `NEUROSYM.scm`: Neurosymbolic integration configuration and hybrid reasoning settings.
- `PLAYBOOK.scm`: Operational runbook, workflows, and incident procedures.

Additional artefacts:

- `AI.a2ml`: AI Agent entry point with canonical locations and invariants.
- `AI.djot`: This file — behavioural and operational instructions.
- `TOPOLOGY.md`: Visual architecture map and completion dashboard.

## Project Summary

**Civic-Connect** is a privacy-first civic engagement platform combining:
- **IndieWeb2 Bastion**: Hardened ingress with Oblivious DNS, GraphQL DNS API, post-quantum crypto
- **Civic-Stream**: Government API integration and stream processing
- **Data Layer**: SurrealDB provenance graph + IPFS content-addressed storage
- **CivicConnect Vision**: Gamified civic participation (planned, see `docs/planning/`)

## Repository Roots

- Local repository root: `/var/mnt/eclipse/repos/civic-connect`
- Symlink access: `~/Documents/hyperpolymath-repos/civic-connect`
- GitHub: `https://github.com/hyperpolymath/civic-connect`
- GitLab: `https://gitlab.com/hyperpolymath/civic-connect`
- Repository names are lowercase; dots (`.`) are replaced with hyphens (`-`).

## Sub-Projects

- `civic-stream/` — Government API integration core (~50% complete)
- `indieweb2-bastion/` — Hardened bastion with oDNS, GraphQL DNS, SurrealDB provenance (~60% complete)

## Critical Invariants

1. Post-quantum cryptography mandatory for all signing and encryption
2. No plaintext DNS queries — Oblivious DNS only
3. SurrealDB provenance graph is append-only
4. Consent must be explicit and auditable
5. Self-hosted infrastructure only
6. Chainguard wolfi-base images for all containers
7. SCM files ONLY in `.machine_readable/` (NEVER root)

## Language Policy

### Allowed Languages and Tools

| Language/Tool | Use Case | Notes |
|---------------|----------|-------|
| Rust | Core services, crypto, DNS, API | Primary for performance-critical |
| ReScript | Policy gate, UI components | Type-safe, compiles to JS |
| Deno | Runtime, consent API, signing | Replaces Node/npm/bun |
| Nickel | Policy contracts | Complex config validation |
| Guile Scheme | Metadata/state files | For all `.scm` artefacts |
| Solidity | Smart contracts | Ethereum/Polygon |
| Motoko | Smart contracts | Internet Computer |
| Bash/POSIX Shell | Automation scripts | Keep minimal |

### Banned Languages and Tools

| Banned | Replacement |
|--------|-------------|
| TypeScript | ReScript |
| Node.js | Deno |
| npm/Bun/pnpm/yarn | Deno |
| Go | Rust |
| Python | Julia / Rust / ReScript |
| Java/Kotlin | Rust |
| Docker | Podman + stapeln |

## Container Standards

- **Files**: Always "Containerfile" (never "Dockerfile")
- **Base images**: `cgr.dev/chainguard/wolfi-base:latest`
- **Runtime**: Podman (never Docker)
- **Build/sign**: cerro-torre (Ed25519 signatures, .ctp bundles)
- **Sealing**: selur seal (zero-copy IPC bridge)
- **Orchestration**: selur-compose with compose.toml
- **Execution**: vordr (formally verified container runtime)

## Security Requirements

- No MD5 or SHA-1; use SHA-256+, BLAKE3, or SHAKE3-512
- HTTPS only
- No hardcoded secrets
- Pin all dependencies by SHA
- Include SPDX license headers in all files
- Post-quantum algorithms for all new crypto code

## Enforcement Rules

- Do not create new TypeScript files; convert existing TS to ReScript
- Do not use `package.json` for runtime dependencies; use `deno.json` imports
- Do not include `node_modules` in production; Deno handles dependency caching
- Do not use Go; use Rust
- Do not use Python; use Julia (data/batch), Rust (systems), or ReScript (apps)

## Package Management

- Primary: Guix (`guix.scm`)
- Fallback: Nix (`flake.nix`)
- JavaScript dependencies: Deno (`deno.json` imports)
